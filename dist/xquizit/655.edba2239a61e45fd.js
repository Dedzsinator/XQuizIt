"use strict";(self.webpackChunkxquizit=self.webpackChunkxquizit||[]).push([[655],{7655:(me,E,a)=>{a.r(E),a.d(E,{AuthModule:()=>de});var c=a(9808),e=a(5e3),s=a(3075),O=a(7579),C=(()=>{return(t=C||(C={})).InvalidEmail="Invalid email",t.InvalidPassword="Invalid password",t.EmailExists="Email already exists",t.EmailConfirmed="Email already confirmed",t.EmailNotFound="Email not found",t.InvalidToken="Invalid token",t.NewPasswordMustBeDifferentFromCurrent="New password must be different from current",C;var t})(),M=a(7533),S=a(2070),P=(()=>{return(t=P||(P={})).Admin="admin",t.Ghost="ghost",t.User="user",t.Visiter="visiter",P;var t})();let A=(()=>{class t{constructor(n){this.auth=n,this.user={email:"",password:"",roles:P.User}}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(M.gx))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var h=a(3013),N=a(6696),$=a(5832),I=a(7423),g=a(7322),v=a(5245),R=a(7531);function J(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,12),e.qZA())}function D(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,13),e.qZA())}function z(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,14),e.qZA())}function k(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,15),e.qZA())}function Q(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,16),e.qZA())}let L=(()=>{class t{constructor(n,o,r,u,d,_,f,T){this.api=n,this.auth=o,this.changeDetectorRef=r,this.authFire=u,this.userService=d,this.formBuilder=_,this.router=f,this.snackbarService=T,this.errorHappens=new e.vpe,this.isLoading=!1,this.isPasswordHidden=!0,this.errorMessage="",this.isDestroyed$=new O.x,this.formGroup=this.createFormGroup("change")}get f(){return this.formGroup.controls}ngOnInit(){}ngOnDestroy(){this.isDestroyed$.next(!0),this.isDestroyed$.complete()}onSubmit(){var n,o;this.isLoading=!0,this.formGroup.disable(),this.isPasswordHidden=!0,this.auth.user.email=null===(n=this.f.identifier)||void 0===n?void 0:n.value,this.auth.user.password=null===(o=this.f.password)||void 0===o?void 0:o.value,(0,M.e5)(this.authFire,this.auth.user.email,this.auth.user.password).then(r=>{console.log("retour login",r),this.auth.user.uid=r.user.uid,this.isLoading=!1,this.userService.update(this.auth.user,r.user.uid),this.router.navigate(["/home"]),this.changeDetectorRef.detectChanges()}).catch(r=>{console.log(r),this.isLoading=!1,this.errorHappens.emit(r.message),this.errorMessage=r.message})}createFormGroup(n,o){const r=this.formBuilder.group({identifier:[void 0,[s.kI.required,s.kI.email]],password:[void 0,[s.kI.required]]},{updateOn:n,validators:this.mustNotBeRejectedValidator()});return void 0!==o&&r.setValue(o),r}mustNotBeRejectedValidator(){return()=>{this.errorMessage===C.InvalidEmail?this.f.identifier.setErrors({mustNotBeRejected:!0}):this.errorMessage===C.InvalidPassword?this.f.password.setErrors({mustNotBeRejected:!0}):""!==this.errorMessage&&this.snackbarService.open(this.errorMessage,"warn"),this.errorMessage=""}}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(S.s),e.Y36(A),e.Y36(e.sBO),e.Y36(M.gx),e.Y36(h.K),e.Y36(s.qu),e.Y36(N.F0),e.Y36($.o))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-login"]],outputs:{errorHappens:"errorHappens"},decls:24,vars:9,consts:function(){let i,n,o,r,u,d,_,f,T;return i=$localize`Email address`,n=$localize`Password`,o=$localize`Toggle password visibility`,r=$localize`Submit`,u=$localize`You must fill in this field`,d=$localize`Please check your identifier`,_=$localize`Not a valid email`,f=$localize`You must fill in this field`,T=$localize`Please check your password`,[[1,"section-login"],[3,"formGroup","ngSubmit"],[1,"center-login"],["appearance","outline","color","accent",1,"form-field"],i,["matInput","","formControlName","identifier","autocomplete","email","type","email"],[4,"ngIf"],["matInput","","formControlName","password","id","current-password","autocomplete","current-password",3,"type"],n,["type","button","mat-icon-button","","matSuffix","","aria-label",o,3,"click"],["mat-raised-button","","color","accent","type","submit",1,"icon-after","rounded",3,"disabled"],r,u,d,_,f,T]},template:function(n,o){1&n&&(e.TgZ(0,"section",0)(1,"form",1),e.NdJ("ngSubmit",function(){return o.onSubmit()}),e.TgZ(2,"div",2)(3,"mat-form-field",3)(4,"mat-label"),e.SDv(5,4),e.qZA(),e._UZ(6,"input",5),e.YNc(7,J,2,0,"mat-error",6),e.YNc(8,D,2,0,"mat-error",6),e.YNc(9,z,2,0,"mat-error",6),e.qZA(),e.TgZ(10,"mat-form-field",3),e._UZ(11,"input",7),e.TgZ(12,"mat-label"),e.SDv(13,8),e.qZA(),e.TgZ(14,"button",9),e.NdJ("click",function(){return o.isPasswordHidden=!o.isPasswordHidden}),e.TgZ(15,"mat-icon"),e._uU(16),e.qZA()(),e.YNc(17,k,2,0,"mat-error",6),e.YNc(18,Q,2,0,"mat-error",6),e.qZA(),e.TgZ(19,"button",10)(20,"span"),e.SDv(21,11),e.qZA(),e.TgZ(22,"mat-icon"),e._uU(23,"send"),e.qZA()()()()()),2&n&&(e.xp6(1),e.Q6J("formGroup",o.formGroup),e.xp6(6),e.Q6J("ngIf",null==o.f.identifier||null==o.f.identifier.errors?null:o.f.identifier.errors.required),e.xp6(1),e.Q6J("ngIf",null==o.f.identifier||null==o.f.identifier.errors?null:o.f.identifier.errors.mustNotBeRejected),e.xp6(1),e.Q6J("ngIf",null==o.f.identifier||null==o.f.identifier.errors?null:o.f.identifier.errors.email),e.xp6(2),e.Q6J("type",o.isPasswordHidden?"password":"text"),e.xp6(5),e.Oqu(o.isPasswordHidden?"visibility_off":"visibility"),e.xp6(1),e.Q6J("ngIf",null==o.f.password||null==o.f.password.errors?null:o.f.password.errors.required),e.xp6(1),e.Q6J("ngIf",null==o.f.password||null==o.f.password.errors?null:o.f.password.errors.mustNotBeRejected),e.xp6(1),e.Q6J("disabled",!o.formGroup.valid))},dependencies:[c.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,I.lW,g.TO,g.KE,g.hX,g.R9,v.Hw,R.Nt],styles:["section[_ngcontent-%COMP%]{height:100%;display:flex;justify-content:center;align-items:center;background-repeat:no-repeat;background-size:cover}.center-login[_ngcontent-%COMP%]{padding-top:10px;padding-left:10px;padding-right:10px;text-align:center;opacity:.95}.form-field[_ngcontent-%COMP%]{padding:5px}"]}),t})();function F(t,i){return n=>{const r=n.controls[i];null!==r.errors&&!r.errors.mustMatch||r.setErrors(n.controls[t].value!==r.value?{mustMatch:!0}:null)}}var B=a(2349),G=a(9814);function j(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,21),e.qZA())}function x(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,22),e.qZA())}function V(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,23),e.qZA())}function K(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,24),e.qZA())}function W(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,25),e.qZA())}function ee(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,26),e.qZA())}function oe(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,27),e.qZA())}function te(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,28),e.qZA())}function ne(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,29),e.qZA())}function re(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,30),e.qZA())}function ie(t,i){1&t&&(e.TgZ(0,"mat-error"),e.SDv(1,31),e.qZA())}function se(t,i){if(1&t&&(e.TgZ(0,"mat-radio-button",32),e._UZ(1,"img",33),e.qZA()),2&t){const n=i.$implicit,o=e.oxw();e.Q6J("value",n)("checked",o.defaultavatar===n),e.xp6(1),e.MGl("src","assets/avatar/",n,"",e.LSH)}}function le(t,i){if(1&t&&(e.TgZ(0,"button",34)(1,"span"),e.SDv(2,35),e.qZA(),e.TgZ(3,"mat-icon"),e._uU(4,"send"),e.qZA()()),2&t){const n=e.oxw();e.Q6J("disabled",!n.formGroup.valid)}}let ae=(()=>{class t{constructor(n,o,r,u,d,_,f,T,m){this.auth=n,this.authFire=o,this.apiService=r,this.formBuilder=u,this.router=d,this.snackbarService=_,this.dialog=f,this.userService=T,this.changeDetectorRef=m,this.errorHappens=new e.vpe,this.isLoading=!1,this.isPasswordHidden=!0,this.errorMessage="",this.imgUrls=[],this.defaultavatar="0-1.png",this.isDestroyed$=new O.x,this.formGroup=this.createFormGroup("change");for(let p=1;p<=100;p++)this.imgUrls.push("0-"+p+".png")}get f(){return this.formGroup.controls}ngOnInit(){}ngOnDestroy(){this.isDestroyed$.next(!0),this.isDestroyed$.complete()}onSubmit(){var n,o,r,u,d;this.formGroup.disable(),this.isPasswordHidden=!0,this.auth.user.firstName=null===(n=this.f.firstName)||void 0===n?void 0:n.value,this.auth.user.lastName=null===(o=this.f.lastName)||void 0===o?void 0:o.value,this.auth.user.email=null===(r=this.f.email)||void 0===r?void 0:r.value,this.auth.user.password=null===(u=this.f.password)||void 0===u?void 0:u.value,this.auth.user.avatar=null===(d=this.f.avatar)||void 0===d?void 0:d.value,(0,M.Xb)(this.authFire,this.auth.user.email,this.auth.user.password).then(_=>{console.log(_),this.auth.user.uid=_.user.uid,this.apiService.setFireUsers(this.auth.user),this.userService.update(this.auth.user,_.user.uid),this.router.navigate(["/home"])}).catch(_=>{console.log(_.code,_.messager),this.errorHappens.emit(_.message),this.errorMessage=_.message,this.isLoading=!1})}onCloseDialog(){return this.dialog.closeAll(),this.router.navigate(["home"])}createFormGroup(n,o){const r=this.formBuilder.group({firstName:[null,[s.kI.required]],lastName:[null,[s.kI.required]],email:[null,[s.kI.required,s.kI.email]],password:[null,[s.kI.required,s.kI.pattern(/^.{8,255}$/)]],confirmPassword:[null,[s.kI.required]],avatar:[null,[s.kI.required]]},{updateOn:n,validators:[F("password","confirmPassword"),this.mustNotBeRejectedValidator()]});return void 0!==o&&r.setValue(o),r}mustNotBeRejectedValidator(){return n=>{this.errorMessage===C.EmailExists?n.controls.email.setErrors({mustNotBeRejected:!0}):""!==this.errorMessage&&this.snackbarService.open(this.errorMessage,"warn"),this.errorMessage=""}}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(A),e.Y36(M.gx),e.Y36(S.s),e.Y36(s.qu),e.Y36(N.F0),e.Y36($.o),e.Y36(B.uw),e.Y36(h.K),e.Y36(e.sBO))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-compte"]],outputs:{errorHappens:"errorHappens"},decls:45,vars:23,consts:function(){let i,n,o,r,u,d,_,f,T,m,p,y,w,Z,H,U,b,X,Y,q;return i=$localize`First name`,n=$localize`Last name`,o=$localize`Email address`,r=$localize`Password`,u=$localize`Toggle password visibility`,d=$localize`Confirm password`,_=$localize`Toggle password visibility`,f=$localize`avatar`,T=$localize`You must fill in this field`,m=$localize`Must contain 2-50 alphanumeric characters`,p=$localize`You must fill in this field`,y=$localize`Must contain 2-50 alphanumeric characters`,w=$localize`You must fill in this field`,Z=$localize`Not a valid email`,H=$localize`Email is already taken`,U=$localize`You must fill in this field`,b=$localize`Must contain 8+ characters`,X=$localize`Passwords doesn't match`,Y=$localize`You must fill in this field `,q=$localize`Submit`,[[1,"section-login"],[3,"formGroup","ngSubmit"],[1,"center-login"],["appearance","outline","color","accent",1,"form-field"],i,["matInput","","formControlName","firstName","color","primary","autocomplete","given-name","required",""],[4,"ngIf"],n,["matInput","","formControlName","lastName","color","primary","autocomplete","family-name","required",""],o,["matInput","","formControlName","email","color","primary","autocomplete","email","type","email","required",""],["matInput","","formControlName","password","id","new-password","autocomplete","new-password","required","",3,"type"],r,["type","button","mat-icon-button","","matSuffix","","aria-label",u,3,"click"],["matInput","","formControlName","confirmPassword","required","",3,"type"],d,["type","button","mat-icon-button","","matSuffix","","aria-label",_,3,"click"],f,["aria-label","Select an option","formControlName","avatar","name","avatar",1,"flex-row",3,"ngModel","ngModelChange"],[3,"value","checked",4,"ngFor","ngForOf"],["mat-raised-button","","class","icon-after rounded","color","accent","type","submit",3,"disabled",4,"ngIf"],T,m,p,y,w,Z,H,U,b,X,Y,[3,"value","checked"],["width","40px",3,"src"],["mat-raised-button","","color","accent","type","submit",1,"icon-after","rounded",3,"disabled"],q]},template:function(n,o){1&n&&(e.TgZ(0,"section",0)(1,"form",1),e.NdJ("ngSubmit",function(){return o.onSubmit()}),e.TgZ(2,"div",2)(3,"mat-form-field",3)(4,"mat-label"),e.SDv(5,4),e.qZA(),e._UZ(6,"input",5),e.YNc(7,j,2,0,"mat-error",6),e.YNc(8,x,2,0,"mat-error",6),e.qZA(),e.TgZ(9,"mat-form-field",3)(10,"mat-label"),e.SDv(11,7),e.qZA(),e._UZ(12,"input",8),e.YNc(13,V,2,0,"mat-error",6),e.YNc(14,K,2,0,"mat-error",6),e.qZA(),e.TgZ(15,"mat-form-field",3)(16,"mat-label"),e.SDv(17,9),e.qZA(),e._UZ(18,"input",10),e.YNc(19,W,2,0,"mat-error",6),e.YNc(20,ee,2,0,"mat-error",6),e.YNc(21,oe,2,0,"mat-error",6),e.qZA(),e.TgZ(22,"mat-form-field",3),e._UZ(23,"input",11),e.TgZ(24,"mat-label"),e.SDv(25,12),e.qZA(),e.TgZ(26,"button",13),e.NdJ("click",function(){return o.isPasswordHidden=!o.isPasswordHidden}),e.TgZ(27,"mat-icon"),e._uU(28),e.qZA()(),e.YNc(29,te,2,0,"mat-error",6),e.YNc(30,ne,2,0,"mat-error",6),e.qZA(),e.TgZ(31,"mat-form-field",3),e._UZ(32,"input",14),e.TgZ(33,"mat-label"),e.SDv(34,15),e.qZA(),e.TgZ(35,"button",16),e.NdJ("click",function(){return o.isPasswordHidden=!o.isPasswordHidden}),e.TgZ(36,"mat-icon"),e._uU(37),e.qZA()(),e.YNc(38,re,2,0,"mat-error",6),e.YNc(39,ie,2,0,"mat-error",6),e.qZA(),e.TgZ(40,"mat-label"),e.SDv(41,17),e.qZA(),e.TgZ(42,"mat-radio-group",18),e.NdJ("ngModelChange",function(u){return o.defaultavatar=u}),e.YNc(43,se,2,3,"mat-radio-button",19),e.qZA(),e.YNc(44,le,5,1,"button",20),e.qZA()()()),2&n&&(e.xp6(1),e.Q6J("formGroup",o.formGroup),e.xp6(6),e.Q6J("ngIf",null==o.f.firstName||null==o.f.firstName.errors?null:o.f.firstName.errors.required),e.xp6(1),e.Q6J("ngIf",null==o.f.firstName||null==o.f.firstName.errors?null:o.f.firstName.errors.pattern),e.xp6(5),e.Q6J("ngIf",null==o.f.lastName||null==o.f.lastName.errors?null:o.f.lastName.errors.required),e.xp6(1),e.Q6J("ngIf",null==o.f.lastName||null==o.f.lastName.errors?null:o.f.lastName.errors.pattern),e.xp6(5),e.Q6J("ngIf",null==o.f.email||null==o.f.email.errors?null:o.f.email.errors.required),e.xp6(1),e.Q6J("ngIf",null==o.f.email||null==o.f.email.errors?null:o.f.email.errors.email),e.xp6(1),e.Q6J("ngIf",null==o.f.email||null==o.f.email.errors?null:o.f.email.errors.mustNotBeRejected),e.xp6(2),e.Q6J("type",o.isPasswordHidden?"password":"text"),e.xp6(3),e.uIk("aria-label","isPasswordHidden password")("aria-pressed",o.isPasswordHidden),e.xp6(2),e.Oqu(o.isPasswordHidden?"visibility_off":"visibility"),e.xp6(1),e.Q6J("ngIf",null==o.f.password||null==o.f.password.errors?null:o.f.password.errors.required),e.xp6(1),e.Q6J("ngIf",null==o.f.password||null==o.f.password.errors?null:o.f.password.errors.pattern),e.xp6(2),e.Q6J("type",o.isPasswordHidden?"password":"text"),e.xp6(3),e.uIk("aria-label","isPasswordHidden password")("aria-pressed",o.isPasswordHidden),e.xp6(2),e.hij(" ",o.isPasswordHidden?"visibility_off":"visibility"," "),e.xp6(1),e.Q6J("ngIf",null==o.f.confirmPassword||null==o.f.confirmPassword.errors?null:o.f.confirmPassword.errors.mustMatch),e.xp6(1),e.Q6J("ngIf",null==o.f.confirmPassword||null==o.f.confirmPassword.errors?null:o.f.confirmPassword.errors.required),e.xp6(3),e.Q6J("ngModel",o.defaultavatar),e.xp6(1),e.Q6J("ngForOf",o.imgUrls),e.xp6(1),e.Q6J("ngIf",!o.isLoading))},dependencies:[c.sg,c.O5,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.sg,s.u,G.VQ,G.U0,I.lW,g.TO,g.KE,g.hX,g.R9,v.Hw,R.Nt],styles:["section[_ngcontent-%COMP%]{height:100%;display:flex;justify-content:center;align-items:center;background-repeat:no-repeat;background-size:cover}.center-login[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;padding:10px;text-align:center;opacity:.95}"]}),t})();var _e=a(8523);const ue=[{path:"",component:L},{path:"login",component:L},{path:"compte",component:ae}];let de=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[c.ez,_e.m,N.Bz.forChild(ue)]}),t})()}}]);